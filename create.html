<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>MÃ©mento IA â€“ ENSOSP | CrÃ©ation de fiche</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Police Inter -->
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">

  <!-- Styles ENSOSP -->
  <link rel="stylesheet" href="style.css" />

  <!-- Lib compression / QR code -->
  <script src="https://unpkg.com/pako@2.1.0/dist/pako.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>

<body>

  <!-- ========================================================= -->
  <!-- BARRE D'ONGLETS + Retour Accueil -->
  <!-- ========================================================= -->
  <nav class="tabs">
    <a href="index.html" class="tab">ğŸ  Accueil</a>
    <a href="scan.html" class="tab">ğŸ“· Lecture QR</a>
    <a class="tab active">ğŸ“ CrÃ©ation de fiche</a>
  </nav>

  <main>

    <h1 class="page-title">CrÃ©ation de fiche opÃ©rationnelle IA</h1>

    <!-- Bouton rÃ©initialiser -->
    <button id="btnReset" class="btn-reset">ğŸ”„ RÃ©initialiser tout</button>

    <!-- ========================================================= -->
    <!-- SECTION METADONNÃ‰ES -->
    <!-- ========================================================= -->
    <section class="card">
      <h2>1. MÃ©tadonnÃ©es de la fiche</h2>

      <label>CatÃ©gorie
        <input id="meta_categorie" type="text" placeholder="Ex : Risque chimique / opÃ©rationnel">
      </label>

      <label>Titre de la fiche
        <input id="meta_titre" type="text" placeholder="Ex : Analyse initiale d'un site RCH">
      </label>

      <label>Objectif
        <input id="meta_objectif" type="text" placeholder="Ex : Aider le RCH3/RCH4 dans l'analyse rapide">
      </label>

      <label>Concepteur
        <input id="meta_concepteur" type="text" placeholder="Ex : Cdt Tirelle">
      </label>

      <label>Version
        <input id="meta_version" type="text" placeholder="Ex : 1.0" value="1.0">
      </label>

      <label>Date de mise Ã  jour
        <input id="meta_date" type="date">
      </label>
    </section>

    <!-- ========================================================= -->
    <!-- INDICES DE CONFIANCE IA -->
    <!-- ========================================================= -->
    <section class="card">
      <h2>2. Indices de confiance IA</h2>

      <label>ChatGPT
        <select id="aiChatGPT" class="indice-confiance">
          <option value="3">3 - RecommandÃ©e</option>
          <option value="2">2 - Acceptable</option>
          <option value="1">1 - Non recommandÃ©e</option>
        </select>
      </label>

      <label>Perplexity
        <select id="aiPerplexity" class="indice-confiance">
          <option value="3">3 - RecommandÃ©e</option>
          <option value="2">2 - Acceptable</option>
          <option value="1">1 - Non recommandÃ©e</option>
        </select>
      </label>

      <label>Mistral
        <select id="aiMistral" class="indice-confiance">
          <option value="3">3 - RecommandÃ©e</option>
          <option value="2">2 - Acceptable</option>
          <option value="1">1 - Non recommandÃ©e</option>
        </select>
      </label>
    </section>

    <!-- ========================================================= -->
    <!-- VARIABLES -->
    <!-- ========================================================= -->
    <section class="card">
      <h2>3. Variables utilisables dans le prompt (max 10)</h2>

      <p class="helper">
        Exemple : variable ID <b>code_onu</b> â†’ utilisable dans le prompt avec <code>{{code_onu}}</code>
      </p>

      <div id="variablesContainer"></div>

      <button id="btnAddVariable" class="btn-add-var">â• Ajouter une variable</button>
    </section>


    <!-- ========================================================= -->
    <!-- PROMPT -->
    <!-- ========================================================= -->
    <section class="card">
      <h2>4. RÃ©daction du prompt</h2>
      <p class="helper">
        Limite : <strong>4000 caractÃ¨res</strong> aprÃ¨s compactage.<br>
        Utilisez les variables avec <code>{{identifiant}}</code>.
      </p>

      <textarea id="prompt_input" rows="10" placeholder="RÃ©digez le prompt iciâ€¦"></textarea>
      <div id="prompt_count" class="counter">0 / 4000</div>
    </section>

    <!-- ========================================================= -->
    <!-- GENERATION DU QR CODE + URL -->
    <!-- ========================================================= -->
    <section class="card">
      <h2>5. GÃ©nÃ©ration du QR Code + URL cliquable</h2>

      <button id="btnGenerate" class="btn-generate">ğŸš€ GÃ©nÃ©rer JSON + QR code + URL</button>

      <!-- Zone QR Code -->
      <div id="qrContainer" class="qr-box"></div>

      <!-- Zone URL (masquÃ©e par dÃ©faut) -->
      <div id="urlContainer" style="display:none;margin-top:20px;">
        <h3 style="color:#001F8F;margin-bottom:10px;">ğŸ”— URL cliquable gÃ©nÃ©rÃ©e</h3>
        
        <div style="background:#eef2ff;padding:15px;border-radius:10px;margin-bottom:15px;">
          <label style="display:block;margin-bottom:8px;font-weight:600;color:#001F8F;">
            Lien Ã  utiliser dans votre PDF :
          </label>
          <input 
            id="generatedUrlCreate" 
            type="text" 
            readonly 
            style="width:100%;padding:12px;border:2px solid #001F8F;border-radius:8px;font-size:14px;background:white;font-family:monospace;word-break:break-all;"
          >
          <button id="btnCopyUrlCreate" class="btn-add-var" style="margin-top:10px;">
            ğŸ“‹ Copier l'URL
          </button>
        </div>

        <div style="background:#f9f9f9;padding:15px;border-radius:10px;font-size:14px;">
          <strong style="color:#001F8F;">ğŸ’¡ Utilisation de l'URL :</strong>
          <ul style="margin:10px 0;padding-left:20px;line-height:1.8;">
            <li><strong>Word :</strong> InsÃ©rez votre QR â†’ Clic droit â†’ Lien hypertexte â†’ Collez l'URL</li>
            <li><strong>Adobe Acrobat :</strong> Outils â†’ Modifier PDF â†’ Ajouter lien â†’ Collez l'URL</li>
            <li><strong>PowerPoint :</strong> InsÃ©rez le QR â†’ Clic droit â†’ Lien â†’ Collez l'URL</li>
          </ul>
          <p style="margin:10px 0;padding:10px;background:#fff3cd;border-radius:6px;">
            <strong>RÃ©sultat :</strong> Quand on clique sur le QR dans le PDF, la fiche s'ouvre directement !
          </p>
        </div>
      </div>
    </section>

  </main>


  <!-- ========================================================= -->
  <!-- SCRIPTS UI -->
  <!-- ========================================================= -->
  <script type="module" src="./src/ui/createFiche.js"></script>

</body>
</html>
